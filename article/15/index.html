<!DOCTYPE html>
<html lang="en">


  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
  

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0,maximum-scale=1.0">

  
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100;300;400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono&display=swap" rel="stylesheet">


  
  <link type="image/ico" rel="icon" href="/favicon.ico"/>
  <link rel="shortcut icon" href="https://www.kosh.dev/favicon.ico"/>
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://www.kosh.dev/icon/apple-touch-icon.png" />
  <link rel="icon" type="image/png" href=href="https://www.kosh.dev/icon/android-chrome-192x192.png"/>
  <link rel="icon" type="image/png" sizes="32x32" href=""/icon/icon-32x32.png", trailing_slash=false) | safe }}"/>
  <link rel="icon" type="image/png" sizes="16x16" href="/icon/icon-16x16.png", trailing_slash=false) | safe }}"/>
  <meta name="theme-color" content="#ffffff"/>

  
  <link rel ="stylesheet" href="https://www.kosh.dev/main.css"/>

  
  
  
  <meta property="og:site_name" content="kosh.dev" />
  <meta name="twitter:card" content="summary">
  <meta property="og:image" content="https://www.kosh.dev/icon/og-image.png" />

  

  <meta property="og:url" content="https://www.kosh.dev/article&#x2F;{{page.slug}}&#x2F;" />
  <meta property="og:title" content="OpenSeeFaceとGodot4を繋ぐ"/>
  <meta name="description" content="OpenSeeFaceで顔のランドマークを検出して、結果をソケット通信(UDP)で受け取ったときのメモです。" />
  <meta property="description" content="OpenSeeFaceで顔のランドマークを検出して、結果をソケット通信(UDP)で受け取ったときのメモです。" />
  <meta property="og:type" content="article" />
<title> OpenSeeFaceとGodot4を繋ぐ| kosh.dev</title>


</head>

<body>
  <header id="header" class="pinned" ><div class="items">
        <div class="item logo"><a href="/">kosh.dev</a></div></div>
  </header>

  <main>
    

<div class="article">
    <h1 class="title">OpenSeeFaceとGodot4を繋ぐ</h1>
    <div class='info'>
        <div class='date'>2023-06-03</div>
        
            
            <div class="htag"><a href="https://www.kosh.dev/tags/godot4/">Godot4</a></div>
            
        
            
            <div class="htag"><a href="https://www.kosh.dev/tags/openseeface/">OpenSeeFace</a></div>
            
        
            
            <div class="htag"><a href="https://www.kosh.dev/tags/python/">Python</a></div>
            
        
    </div>
<div class="contents">

<p>OpenSeeFace<sup class="footnote-reference"><a href="#1">1</a></sup>で顔のランドマークを検出して、結果をソケット通信(UDP)で受け取ったときのメモです。</p>
<p>c#で受け取る例を示します。ついでに、pythonをGodotから実行する方法も載せておきます。</p>
<p>
<div class="toc" id="toc"><ol>
    
        <li><a href="https://www.kosh.dev/article/15/#huan-jing">環境</a></li> 
    
        <li><a href="https://www.kosh.dev/article/15/#openseefacetoha">OpenSeeFaceとは</a></li> 
    
        <li><a href="https://www.kosh.dev/article/15/#detanosong-xin-ce">データの送信側</a></li> 
    
        <li><a href="https://www.kosh.dev/article/15/#godotdeshou-kequ-ru">Godotで受け取る</a></li> 
    
        <li><a href="https://www.kosh.dev/article/15/#pythonwogodotkarahu-bu">pythonをGodotから呼ぶ</a></li> 
    
        <li><a href="https://www.kosh.dev/article/15/#omake-papetutofeng-nochu-li-li">おまけ: パペット風の出力例</a></li> 
    
        <li><a href="https://www.kosh.dev/article/15/#omake-te-zheng-detanomemo">おまけ: 特徴データのメモ</a></li> 
    
        <li><a href="https://www.kosh.dev/article/15/#can-kao-wen-xian">参考文献</a></li> 
     
</ol></div></p>
<h2 id="huan-jing">環境</h2>
<p>Godot: <code>v4.0.2.stable.official</code></p>
<p>Python: <code>3.9.9</code></p>
<p>OpenSeeFace: <code>9e07f6e1993022e7679f2e5ee3daec0ff617fac1</code></p>
<h2 id="openseefacetoha">OpenSeeFaceとは</h2>
<p>OpenSeeFaceは、MobileNetV3に基づいた顔のランドマーク検出モデルを実装したトラッキングライブラリです。
顔の特徴点(ランドマーク)を検出し、それを基に顔の動きを追跡することができます。</p>
<p>Webカメラ入力またはビデオファイルからの顔のトラッキングを行い、そのトラッキングデータを<strong>UDP経由で送信</strong>します。</p>
<p>この送信されたデータは3Dモデル、またはLive2Dモデルのアニメーションで利用できます。</p>
<p>このライブラリでは、複数のモデルを提供しており、ユーザーの環境に合わせて変更できます。</p>
<h2 id="detanosong-xin-ce">データの送信側</h2>
<p>OpenSeeFaceでは<code>facetracker.py</code><sup class="footnote-reference"><a href="#2">2</a></sup>を実行して起動します。</p>
<pre data-lang="bash" class="language-bash z-code"><code class="language-bash" data-lang="bash"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">$</span></span><span class="z-meta z-function-call z-arguments z-shell"> python facetracker.py<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>P</span> 1<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>log-data</span> output.log</span>
</span></code></pre>
<p><code>facetracker.py</code>にてsendtoによりトラッキングデータが送信されています。</p>
<pre data-lang="python" class="language-python z-code"><code class="language-python" data-lang="python"><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">sock</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">sendto</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">packet</span></span><span class="z-punctuation z-separator z-arguments z-python">,</span>  <span class="z-meta z-sequence z-tuple z-python"><span class="z-punctuation z-section z-sequence z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">target_ip</span></span><span class="z-punctuation z-separator z-sequence z-python">,</span>  <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">target_port</span></span><span class="z-punctuation z-section z-sequence z-end z-python">)</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></code></pre>
<p>デフォルトではipがlocalhost(127.0.0.1)、portは11573です。実行時の引数として与えることもできます。</p>
<p><code>packet</code>は<code>bytearray()</code>によって作成され、<code>packet.extend(bytearray(struct.pack(&quot;d&quot;,  now)))</code>のようにデータを追加しています。</p>
<p>何のデータが出力されているかはlogファイルを確認するのが良いでしょう。少し多すぎるのでここでの記載は省略しますが、各フィードのメモをおまけとして追加しておきます。</p>
<!-- [特徴データのメモ](#_4) -->
<h2 id="godotdeshou-kequ-ru">Godotで受け取る</h2>
<p>c#では、UDPのサーバーとして<code>UDPServer</code><sup class="footnote-reference"><a href="#3">3</a></sup>を使用できます。</p>
<p>公式ドキュメントを参考に、以下のようにOpenSeeFaceからデータを取得することができます。</p>
<pre data-lang="c#" class="language-c# z-code"><code class="language-c#" data-lang="c#"><span class="z-source z-cs"><span class="z-support z-type z-cs">extends</span> <span class="z-variable z-other z-cs">Node</span>

<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">server</span> :<span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-variable z-other z-cs">UDPServer</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-instance z-cs"><span class="z-keyword z-operator z-new z-cs">new</span></span><span class="z-meta z-instance z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-instance z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span>

</span></span><span class="z-variable z-other z-cs">func</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">_ready</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>:
	<span class="z-variable z-other z-cs">server</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">listen</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-numeric z-integer z-decimal z-cs">11573</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>


<span class="z-variable z-other z-cs">func</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">_process</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">delta</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>:
	<span class="z-variable z-other z-cs">server</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">poll</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-keyword z-other z-cs">if</span> <span class="z-variable z-other z-cs">server</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">is_connection_available</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>:
		<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">peer</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">server</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">take_connection</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
		<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">packet</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">peer</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">get_packet</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
</span></code></pre>
<p>取得したデータ(<code>packet</code>)はbyte形式ですので、こちらを変換する必要があります。</p>
<p>そこで一旦、変換用の関数を定義しておきます。(もしかするともう少しいい変換方法があるかもです。)</p>
<pre data-lang="c#" class="language-c# z-code"><code class="language-c#" data-lang="c#"><span class="z-source z-cs"><span class="z-support z-type z-cs">func</span> <span class="z-meta z-method z-cs"><span class="z-entity z-name z-function z-cs">bytes_to_double</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-begin z-cs">(</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-support z-type z-cs">bytes</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-end z-cs">)</span></span><span class="z-meta z-method z-cs"><span class="z-invalid z-illegal z-cs">:</span></span>
	<span class="z-support z-type z-cs">var</span> <span class="z-variable z-other z-cs">double</span>: <span class="z-variable z-other z-cs">float</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-constant z-numeric z-float z-decimal z-cs">0<span class="z-punctuation z-separator z-decimal z-cs">.</span>0</span>
	<span class="z-keyword z-other z-cs">if</span> <span class="z-variable z-other z-cs">bytes</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">size</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span> <span class="z-keyword z-operator z-cs">==</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">8</span>:
		<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">f64</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">bytes</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">decode_double</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-numeric z-integer z-decimal z-cs">0</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
		<span class="z-storage z-type z-cs">double</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">f64</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-keyword z-other z-cs">return</span> <span class="z-storage z-type z-cs">double</span>


<span class="z-variable z-other z-cs">func</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_int</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">bytes</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>:
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">integer</span>: <span class="z-storage z-type z-cs">int</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">0</span>
	<span class="z-keyword z-other z-cs">if</span> <span class="z-variable z-other z-cs">bytes</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">size</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span> <span class="z-keyword z-operator z-cs">==</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>:
		<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">i32</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">bytes</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">decode_u32</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-numeric z-integer z-decimal z-cs">0</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
		<span class="z-variable z-other z-cs">integer</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">int</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">i32</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-keyword z-other z-cs">return</span> <span class="z-variable z-other z-cs">integer</span>


<span class="z-variable z-other z-cs">func</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">bytes</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>:
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">float_number</span>: <span class="z-storage z-type z-cs">float</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-constant z-numeric z-float z-decimal z-cs">0<span class="z-punctuation z-separator z-decimal z-cs">.</span>0</span>
	<span class="z-keyword z-other z-cs">if</span> <span class="z-variable z-other z-cs">bytes</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">size</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span> <span class="z-keyword z-operator z-cs">==</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>:
		<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">f32</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">bytes</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">decode_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-numeric z-integer z-decimal z-cs">0</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
		<span class="z-variable z-other z-cs">float_number</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">f32</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-keyword z-other z-cs">return</span> <span class="z-variable z-other z-cs">float_number</span>
</span></code></pre>
<p>あとはいい感じに受け取ったデータを区切って、辞書型に保存する関数を定義します。</p>
<p>これで<code>data</code>を取得することで特徴データを使用できます。</p>
<pre data-lang="c#" class="language-c# z-code"><code class="language-c#" data-lang="c#"><span class="z-source z-cs">
<span class="z-support z-type z-cs">func</span> <span class="z-meta z-method z-cs"><span class="z-entity z-name z-function z-cs">parse_packet</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-begin z-cs">(</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-support z-type z-cs">packet</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-end z-cs">)</span></span><span class="z-meta z-method z-cs"><span class="z-invalid z-illegal z-cs">:</span></span>
	<span class="z-storage z-type z-variable z-cs">var</span> <span class="z-variable z-other z-cs">data</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-punctuation z-section z-block z-begin z-cs">{</span><span class="z-punctuation z-section z-block z-end z-cs">}</span>
	<span class="z-storage z-type z-variable z-cs">var</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">0</span>

	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">timestamp_bytes</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">8</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">timestamp</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_double</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">timestamp_bytes</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>timestamp<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">timestamp</span>
	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">8</span>

	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">face_id_bytes</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">face_id</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_int</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">face_id_bytes</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>face_id<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">face_id</span>
	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>

	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">width_bytes</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">width</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">width_bytes</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>width<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">width</span>
	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>

	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">height_bytes</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">height</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">height_bytes</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>height<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">height</span>
	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>

	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eye_blink<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span>
	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eye_blink<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">append</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>
	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eye_blink<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">append</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>

	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">success_bytes</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">1</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">success</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_int</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">success_bytes</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>success<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">success</span>
	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">1</span>

	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">pnp_error_bytes</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">pnp_error</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">pnp_error_bytes</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>pnp_error<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">pnp_error</span>
	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>

	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">quaternions</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span>
	<span class="z-keyword z-other z-cs">for</span> <span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-other z-sql z-cs">in</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">range</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>:
		<span class="z-variable z-other z-cs">quaternions</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">append</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span><span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">1</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
		<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>quaternion<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">quaternions</span>

	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">eulers</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span>
	<span class="z-keyword z-other z-cs">for</span> <span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-other z-sql z-cs">in</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">range</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-numeric z-integer z-decimal z-cs">3</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>:
		<span class="z-variable z-other z-cs">eulers</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">append</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span><span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">1</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>euler<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">eulers</span>
	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">12</span>

	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">translations</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span>
	<span class="z-keyword z-other z-cs">for</span> <span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-other z-sql z-cs">in</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">range</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-numeric z-integer z-decimal z-cs">3</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>:
		<span class="z-variable z-other z-cs">translations</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">append</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span><span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">1</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>translation<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">translations</span>
	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">12</span>

	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">66</span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">3</span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>  # <span class="z-variable z-other z-cs">Landmark</span>

	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">66</span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">3</span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>  # <span class="z-variable z-other z-cs">Point3D</span>

	<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">18</span> <span class="z-keyword z-operator z-cs">*</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>  # <span class="z-keyword z-operator z-cs">??</span><span class="z-keyword z-operator z-ternary z-cs">?</span>

<span class="z-meta z-preprocessor z-cs">	<span class="z-keyword z-other z-preprocessor z-cs"><span class="z-punctuation z-definition z-preprocessor z-cs">#</span> </span><span class="z-invalid z-illegal z-cs">Feature list</span></span>
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">features</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs">
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eye_l<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eye_r<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eyebrow_steepness_l<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eyebrow_quirk_l<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span>
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eyebrow_steepness_r<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eyebrow_quirk_r<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eyebrow_updown_l<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span>
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>eyebrow_updown_r<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>mouth_corner_updown_l<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>mouth_corner_inout_l<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span>
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>mouth_corner_updown_r<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>mouth_corner_inout_r<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>mouth_open<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>mouth_wide<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span>
	</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span>

	<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>features<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-punctuation z-section z-block z-begin z-cs">{</span><span class="z-punctuation z-section z-block z-end z-cs">}</span>
	<span class="z-keyword z-other z-cs">for</span> <span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-other z-sql z-cs">in</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">range</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-numeric z-integer z-decimal z-cs">14</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>:
		<span class="z-variable z-other z-cs">data</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>features<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-variable z-other z-cs">features</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-variable z-other z-cs">i</span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">bytes_to_float</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">packet</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">slice</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">index</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
		<span class="z-variable z-other z-cs">index</span> <span class="z-keyword z-operator z-cs">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">4</span>

	<span class="z-keyword z-other z-cs">return</span> <span class="z-variable z-other z-cs">data</span>
</span></code></pre>
<h2 id="pythonwogodotkarahu-bu">pythonをGodotから呼ぶ</h2>
<p>いちいち、<code>facetracker.py</code>を起動して、Godotでパペットを起動してとするのは非常に手間がかかります。</p>
<p>そこでmainのスクリプトなどで最初に実行してしまうことにします。</p>
<p><code>OS.execute</code><sup class="footnote-reference"><a href="#4">4</a></sup>を使うと、OpenSeeFaceが停止するまで、それ以降の処理が実行されません。</p>
<p>そのため、<code>OS.create_process</code><sup class="footnote-reference"><a href="#5">5</a></sup>を使用して、新しいプロセスを作成し、実行します。</p>
<pre data-lang="c#" class="language-c# z-code"><code class="language-c#" data-lang="c#"><span class="z-source z-cs"><span class="z-storage z-modifier z-cs">const</span> <span class="z-variable z-other z-cs">python_cmd</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>&lt;path to python&gt;<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span>

<span class="z-variable z-other z-cs">func</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">run_py</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>:
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">output</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span>
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">args</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span></span><span class="z-meta z-brackets z-cs">
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>OpenSeeFace/facetracker.py<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> 
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>--visualize<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>3<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> 
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>--pnp-points<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>1<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> 
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>--max-threads<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>4<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> 
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>-c<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>0<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> 
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>-P<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>1<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> 
		<span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>-F<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span><span class="z-punctuation z-separator z-accessor z-cs">,</span> <span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">&quot;</span>60<span class="z-punctuation z-definition z-string z-end z-cs">&quot;</span></span></span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span>
	<span class="z-variable z-other z-cs">var</span> <span class="z-variable z-other z-cs">pid</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">OS</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">create_process</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">python_cmd</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">args</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
	
	<span class="z-keyword z-other z-cs">return</span> <span class="z-variable z-other z-cs">pid</span>
</span></code></pre>
<p>これで実行はされます。しかし、これだとGodotが終了してもプロセスが実行され続けてしまいます。</p>
<p><code>_notification</code>関数内で<code>NOTIFICATION_WM_CLOSE_REQUEST</code>を使用してウィンドウが閉じられたことを検出します。。</p>
<p>あとは、実行時に取得したpidを使って<code>OS.kill</code>によってkillします。</p>
<pre data-lang="c#" class="language-c# z-code"><code class="language-c#" data-lang="c#"><span class="z-source z-cs"><span class="z-support z-type z-cs">func</span> <span class="z-meta z-method z-cs"><span class="z-entity z-name z-function z-cs">_notification</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-begin z-cs">(</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-support z-type z-cs">what</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-end z-cs">)</span></span><span class="z-meta z-method z-cs"><span class="z-invalid z-illegal z-cs">:</span></span>
	<span class="z-keyword z-control z-conditional z-if z-cs">if</span> <span class="z-variable z-other z-cs">what</span> <span class="z-keyword z-operator z-cs">==</span> <span class="z-variable z-other z-cs">NOTIFICATION_WM_CLOSE_REQUEST</span>:
		<span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">get_tree</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">set_auto_accept_quit</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-language z-cs">false</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
		<span class="z-variable z-other z-cs">OS</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">kill</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">pid</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
		<span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">get_tree</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">quit</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
</span></code></pre>
<h2 id="omake-papetutofeng-nochu-li-li">おまけ: パペット風の出力例</h2>
<p>上記スクリプトを使って、ためしにパペットを作ってみました。</p>
<p>取得した特徴データのうち目の開閉と口の開閉、加えて顔の傾きを使用して出力しています。</p>
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">顔トラッキング60fpsで動作確認した👀👄<a href="https://twitter.com/hashtag/GODOT4?src=hash&amp;ref_src=twsrc%5Etfw">#GODOT4</a> <a href="https://twitter.com/hashtag/OpenSeeFace?src=hash&amp;ref_src=twsrc%5Etfw">#OpenSeeFace</a> <a href="https://t.co/C7iFZoYZJH">pic.twitter.com/C7iFZoYZJH</a></p>&mdash; kosh (@llbxg) <a href="https://twitter.com/llbxg/status/1655534078911991808?ref_src=twsrc%5Etfw">May 8, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<h2 id="omake-te-zheng-detanomemo">おまけ: 特徴データのメモ</h2>
<p>各フィードのメモです。</p>
<ul>
<li>Frame, Time: 映像フレームのIDとそのタイムスタンプ。</li>
<li>Width, Height: 映像の幅と高さ。</li>
<li>FPS: 映像のフレームレート（フレーム・パー・セカンド）。</li>
<li>Face, FaceID: 顔の検出とその識別子。</li>
<li>RightOpen, LeftOpen: 右目と左目が開いているかどうかの指標。</li>
<li>AverageConfidence: 検出された顔の信頼度の平均。</li>
<li>Success3D, PnPError: 3D顔再構成の成功とそのエラー。</li>
<li>RotationQuat.X, Y, Z, W: 顔の回転を表すクォータニオン。</li>
<li>Euler.X, Y, Z: オイラー角による顔の回転。</li>
<li>RVec.X, Y, Z, TVec.X, Y, Z: 顔の位置と姿勢を表すロドリゲスベクトルと平行移動ベクトル。</li>
<li>Landmark[i].X, Y, Confidence: i番目の顔のランドマーク（特徴点）の位置とその信頼度。</li>
<li>Point3D[i].X, Y, Z: i番目の3Dランドマークの位置。</li>
<li>eye_l, eye_r: 左目と右目の開き具合。</li>
<li>eyebrow_steepness_l, eyebrow_updown_l, eyebrow_quirk_l, eyebrow_steepness_r, eyebrow_updown_r, eyebrow_quirk_r: 左右の眉の特性（傾き、上下動、特異な動き）。</li>
<li>mouth_corner_updown_l, mouth_corner_inout_l, mouth_corner_updown_r, mouth_corner_inout_r: 口角の上下動と内外動。</li>
<li>mouth_open, mouth_wide: 口の開き具合と幅。</li>
</ul>
<h2 id="can-kao-wen-xian">参考文献</h2>
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p><a href="https://github.com/emilianavt/OpenSeeFace">emilianavt/OpenSeeFace - GitHub</a></p>
</div>
<div class="footnote-definition" id="2"><sup class="footnote-definition-label">2</sup>
<p><a href="https://github.com/emilianavt/OpenSeeFace/blob/master/facetracker.py">OpenSeeFace - GitHub - facetracker.py</a></p>
</div>
<div class="footnote-definition" id="3"><sup class="footnote-definition-label">3</sup>
<p><a href="https://docs.godotengine.org/en/stable/classes/class_udpserver.html#udpserver">class_udpserver #udpserver - docs.godotengine.org</a></p>
</div>
<div class="footnote-definition" id="4"><sup class="footnote-definition-label">4</sup>
<p><a href="https://docs.godotengine.org/en/stable/classes/class_os.html#class-os-method-execute">class_os.html #class-os-method-execute - docs.godotengine.org</a></p>
</div>
<div class="footnote-definition" id="5"><sup class="footnote-definition-label">5</sup>
<p><a href="https://docs.godotengine.org/en/stable/classes/class_os.html#class-os-method-create-process">class_os.html #class-os-method-create-process - docs.godotengine.org</a></p>
</div>
<div class="footnote-definition" id="6"><sup class="footnote-definition-label">6</sup>
<p><a href="https://docs.godotengine.org/en/stable/classes/class_os.html#class-os-method-kill">class_os.html #class-os-method-kill - docs.godotengine.org</a></p>
</div>

</div>

</div>



<script src="https://www.kosh.dev/js/internal_external.js"></script>


  </main>

  <footer>
    <div class="item">©&nbsp;kosh&nbsp;2025</div>
    <div class="item"><a href='/about/'>/about</a></div>
    <div class="item"><a href='/atom.xml'>/atom.xml</a></div>
    
<div class="item"><a href="https://github.com/llbxg/llbxg.github.io/blob/main/content/article/15.md">(Edit)</a></div>

    
  </footer>
  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RVMB5GPN2Z"></script>
  <script src="https://www.kosh.dev/js/google_analytics.js"></script>
  

</body>

</html>